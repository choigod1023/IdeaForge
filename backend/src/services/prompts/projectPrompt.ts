import { PromptRequest, Project } from "../../types";

export class ProjectPrompt {
  private static readonly SYSTEM_PROMPT = `ğŸ¯ ë‹¹ì‹ ì€ ê°œë°œìë“¤ì—ê²Œ ë§ì¶¤í˜• í”„ë¡œì íŠ¸ ì•„ì´ë””ì–´ë¥¼ ì¶”ì²œí•˜ëŠ” í”„ë¡œê·¸ë˜ë° ë©˜í† ì…ë‹ˆë‹¤. 

ğŸ“‹ í”„ë¡œì íŠ¸ ìœ í˜•:
1) ğŸ® í† ì´ í”„ë¡œì íŠ¸: ì¬ë¯¸ìˆê³  í•™ìŠµ ëª©ì ì˜ ì‘ì€ í”„ë¡œì íŠ¸
2) ğŸ† í¬íŠ¸í´ë¦¬ì˜¤ í”„ë¡œì íŠ¸: ì‹¤ë¬´ì—ì„œ í™œìš© ê°€ëŠ¥í•œ ì™„ì„±ë„ ë†’ì€ í”„ë¡œì íŠ¸
3) ğŸŒŸ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸: ì»¤ë®¤ë‹ˆí‹°ì— ê¸°ì—¬í•  ìˆ˜ ìˆëŠ” í”„ë¡œì íŠ¸
4) ğŸ’¡ ì‹¤ìš© í”„ë¡œì íŠ¸: ì‹¤ì œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” í”„ë¡œì íŠ¸

âœ¨ ì¶”ì²œì€ ê°œë°œìì˜ ê¸°ìˆ  ìˆ˜ì¤€ê³¼ ê´€ì‹¬ì‚¬ì— ë§ì¶°ì ¸ì•¼ í•˜ë©°, ê° í”„ë¡œì íŠ¸ ìœ í˜•ì— ì í•©í•œ ë‚œì´ë„ì™€ ë²”ìœ„ë¥¼ ì œì‹œí•´ì•¼ í•©ë‹ˆë‹¤.
ğŸ†• íŠ¹íˆ ê¸°ì¡´ í”„ë¡œì íŠ¸ì™€ ìœ ì‚¬í•˜ì§€ ì•Šìœ¼ë©´ì„œë„ ì„ íƒí•œ í…Œë§ˆì— ë§ëŠ” ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ì œì‹œí•´ì•¼ í•©ë‹ˆë‹¤.

ğŸ“ ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”.`;

  private static readonly PROJECT_CONSTRAINTS = `
      âš ï¸ í”„ë¡œì íŠ¸ ì œì•½ì‚¬í•­:
      âŒ ì œì™¸í•  í”„ë¡œì íŠ¸ ìœ í˜•:
        * ğŸ“ í•  ì¼ ê´€ë¦¬ ì•±, ë©”ëª¨ ì•±, ì±„íŒ… ì•±, ë¸”ë¡œê·¸, ì‡¼í•‘ëª° ë“± í”í•œ CRUD ì•±
        * ğŸ§® ë‹¨ìˆœí•œ ê³„ì‚°ê¸°, íƒ€ì´ë¨¸, ë‚ ì”¨ ì•± ë“± ê¸°ë³¸ì ì¸ ìœ í‹¸ë¦¬í‹° ì•±
        * ğŸ¯ ê¸°ì¡´ ì„œë¹„ìŠ¤ì˜ ë‹¨ìˆœ í´ë¡  í”„ë¡œì íŠ¸
        * ğŸ”„ ìœ„ ê¸°ì¡´ í”„ë¡œì íŠ¸ ëª©ë¡ê³¼ ìœ ì‚¬í•œ í”„ë¡œì íŠ¸
        * ğŸ” ë™ì¼í•œ ë„ë©”ì¸ì—ì„œ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” í”„ë¡œì íŠ¸ (ì˜ˆ: ë†ì—… ë°ì´í„° ë¶„ì„ ì•±ê³¼ ë†ì—… ë°ì´í„° ë¶„ì„ ìœ í‹¸ë¦¬í‹°)
      
      âœ… ì¶”ì²œí•  í”„ë¡œì íŠ¸ ë°©í–¥:
        * ğŸ¢ íŠ¹ì • ì‚°ì—…/ë„ë©”ì¸ì˜ ì‹¤ì œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” í”„ë¡œì íŠ¸ (ì˜ˆ: ë†ì—…, ì˜ë£Œ, êµìœ¡, í™˜ê²½ ë“±)
        * ğŸš€ ìƒˆë¡œìš´ ê¸°ìˆ  íŠ¸ë Œë“œë¥¼ í™œìš©í•œ í”„ë¡œì íŠ¸ (ì˜ˆ: AI, ë¸”ë¡ì²´ì¸, IoT, AR/VR ë“±)
        * ğŸ’ª ê¸°ì¡´ ì„œë¹„ìŠ¤ì˜ í•œê³„ë¥¼ ê°œì„ í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ê´€ì ì„ ì œì‹œí•˜ëŠ” í”„ë¡œì íŠ¸
        * ğŸ‘¥ íŠ¹ì • ì‚¬ìš©ì ê·¸ë£¹ì˜ ë‹ˆì¦ˆë¥¼ ì¶©ì¡±ì‹œí‚¤ëŠ” í”„ë¡œì íŠ¸ (ì˜ˆ: ì¥ì• ì¸, ë…¸ì¸, í•™ìƒ ë“±)
        * ğŸŒ ì‚¬íšŒì  ê°€ì¹˜ë¥¼ ì°½ì¶œí•˜ëŠ” í”„ë¡œì íŠ¸ (ì˜ˆ: í™˜ê²½ ë³´í˜¸, êµìœ¡ ê²©ì°¨ í•´ì†Œ ë“±)
        
      ğŸ” ì¤‘ë³µ ë°©ì§€ ê°€ì´ë“œë¼ì¸:
        * ë™ì¼í•œ ë„ë©”ì¸ì—ì„œ ë‹¤ë¥¸ ê´€ì ì´ë‚˜ ì ‘ê·¼ ë°©ì‹ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”
        * ì˜ˆì‹œ:
          - ë†ì—… ë°ì´í„° ë¶„ì„ â†’ ë†ì‘ë¬¼ ì§ˆë³‘ ì˜ˆì¸¡ AI ì‹œìŠ¤í…œ
          - ë†ì—… ë°ì´í„° ë¶„ì„ â†’ ìŠ¤ë§ˆíŠ¸ ë†ì¥ ìë™í™” ì‹œìŠ¤í…œ
          - ë†ì—… ë°ì´í„° ë¶„ì„ â†’ ë†ì‚°ë¬¼ ìœ í†µ ìµœì í™” í”Œë«í¼
        * ê° í”„ë¡œì íŠ¸ëŠ” ê³ ìœ í•œ ê°€ì¹˜ì™€ ëª©ì ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤
        * ìœ ì‚¬í•œ ê¸°ìˆ  ìŠ¤íƒì„ ì‚¬ìš©í•˜ë”ë¼ë„ ë‹¤ë¥¸ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤`;

  private static readonly PROJECT_CRITERIA = `
      ğŸ¯ í”„ë¡œì íŠ¸ ê¸°ì¤€:
        * ğŸ“Š í•´ë‹¹ ë‚œì´ë„ì— ë§ëŠ” êµ¬í˜„ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì´ì–´ì•¼ í•©ë‹ˆë‹¤
        * ğŸ‘¥ ì‹¤ì œ ì‚¬ìš©ìë‚˜ ì»¤ë®¤ë‹ˆí‹°ì— ë„ì›€ì´ ë  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤
        * ğŸ“š ê¸°ìˆ ì ìœ¼ë¡œ ë„ì „ì ì´ë©´ì„œë„ í•™ìŠµ ê°€ì¹˜ê°€ ë†’ì•„ì•¼ í•©ë‹ˆë‹¤
        * âœ¨ ê¸°ì¡´ í”„ë¡œì íŠ¸ì™€ ì°¨ë³„í™”ëœ íŠ¹ì§•ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤
        * ğŸ“ˆ í™•ì¥ ê°€ëŠ¥ì„±ì´ë‚˜ ë°œì „ ê°€ëŠ¥ì„±ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤`;

  static readonly RESOURCE_EVALUATION_CRITERIA = `
      ğŸ“š ì°¸ê³  ìë£Œ í‰ê°€ ê¸°ì¤€:
      1. ğŸ” ê´€ë ¨ì„± (0-100)
         - í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ê¸°ëŠ¥ê³¼ ì–¼ë§ˆë‚˜ ê´€ë ¨ì´ ìˆëŠ”ê°€?
         - ê¸°ìˆ  ìŠ¤íƒê³¼ ì–¼ë§ˆë‚˜ ì¼ì¹˜í•˜ëŠ”ê°€?
         - í”„ë¡œì íŠ¸ì˜ ëª©í‘œì™€ ì–¼ë§ˆë‚˜ ë¶€í•©í•˜ëŠ”ê°€?
      
      2. â­ í’ˆì§ˆ (0-100)
         - ìë£Œì˜ ì‹ ë¢°ì„±ê³¼ ì „ë¬¸ì„±
         - ìµœì‹ ì„± (ìµœê·¼ 2ë…„ ì´ë‚´ì¸ê°€?)
         - ì‹¤ì œ êµ¬í˜„ ì‚¬ë¡€ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ê°€?
      
      3. ğŸ“– í•™ìŠµ ê°€ì¹˜ (0-100)
         - ìƒˆë¡œìš´ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ëŠ”ê°€?
         - ì‹¤ì œ ì ìš© ê°€ëŠ¥í•œ ë‚´ìš©ì¸ê°€?
         - ë¬¸ì œ í•´ê²° ë°©ë²•ì´ êµ¬ì²´ì ì¸ê°€?
      
      4. ğŸ› ï¸ ì‹¤ìš©ì„± (0-100)
         - ë°”ë¡œ ì ìš© ê°€ëŠ¥í•œ ì½”ë“œë‚˜ ì˜ˆì œê°€ ìˆëŠ”ê°€?
         - ë‹¨ê³„ë³„ ê°€ì´ë“œê°€ ì œê³µë˜ëŠ”ê°€?
         - ì‹¤ì œ í”„ë¡œì íŠ¸ì— ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ”ê°€?`;

  private static readonly JSON_SCHEMA = `
      ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì •í™•íˆ ì‘ë‹µí•´ì£¼ì„¸ìš” (ëª¨ë“  í•„ë“œëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤):
      {
        "id": "í”„ë¡œì íŠ¸-ê³ ìœ -id",
        "title": "ğŸ¯ í”„ë¡œì íŠ¸ ì œëª© (í•œê¸€ë¡œ ì‘ì„±, 10ì ì´ë‚´)",
        "description": {
          "summary": "âœ¨ í”„ë¡œì íŠ¸ í•œ ì¤„ ìš”ì•½ (í•œê¸€ë¡œ ì‘ì„±, 18ì ì´ë‚´)",
          "keyPoints": [
            "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 1 (í•œê¸€ë¡œ ì‘ì„±, 15ì ì´ë‚´)",
            "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 2 (í•œê¸€ë¡œ ì‘ì„±, 15ì ì´ë‚´)",
            "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 3 (í•œê¸€ë¡œ ì‘ì„±, 15ì ì´ë‚´)"
          ]
        },
        "techStack": [
          {
            "name": "ğŸ› ï¸ ê¸°ìˆ  ì´ë¦„",
            "descriptions": [
              "âœ¨ ì´ ê¸°ìˆ ì˜ í•µì‹¬ íŠ¹ì§•ì„ ê°„ë‹¨í•˜ê³  ì¹œê·¼í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš” (~ìš”ë¡œ ëë‚˜ë„ë¡)",
              "ğŸ’ª ì´ ê¸°ìˆ ì´ í”„ë¡œì íŠ¸ì— ì–´ë–¤ ë„ì›€ì„ ì£¼ëŠ”ì§€ ì„¤ëª…í•´ì£¼ì„¸ìš”",
              "ğŸŒŸ ì´ ê¸°ìˆ ì˜ ì£¼ìš” ì¥ì ì´ë‚˜ íŠ¹ë³„í•œ ì ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”"
            ]
          }
        ],
        "difficulty": "ğŸ“Š ë‚œì´ë„",
        "projectType": ["ğŸ¯ í”„ë¡œì íŠ¸ ìœ í˜•"],
        "features": [
          {
            "mainTitle": "âœ¨ ì£¼ìš” ê¸°ëŠ¥ ì˜ì—­",
            "description": "ì´ ê¸°ëŠ¥ ì˜ì—­ì— ëŒ€í•œ ì „ì²´ì ì¸ ì„¤ëª… (~ìš”ë¡œ ëë‚˜ë„ë¡)",
            "items": [
              {
                "title": "ğŸ“Œ ì„¸ë¶€ ê¸°ëŠ¥ ì œëª©",
                "description": "ì„¸ë¶€ ê¸°ëŠ¥ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª… (ì‚¬ìš©ì ê´€ì ì—ì„œ ì„¤ëª…, ~ìš”ë¡œ ëë‚˜ë„ë¡)",
                "keyPoints": [
                  "ğŸ’¡ ì£¼ìš” íŠ¹ì§• 1",
                  "ğŸ’¡ ì£¼ìš” íŠ¹ì§• 2",
                  "ğŸ’¡ ì£¼ìš” íŠ¹ì§• 3"
                ]
              }
            ]
          }
        ],
        "resources": [
          {
            "category": "ğŸ“š ì¹´í…Œê³ ë¦¬",
            "title": "ğŸ“– ìë£Œ ì œëª©",
            "url": "ğŸ”— URL",
            "description": "ìë£Œì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª… (100ì ì´ë‚´)",
            "learningPoints": [
              "ğŸ“ ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸ 1 (50ì ì´ë‚´)",
              "ğŸ“ ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸ 2 (50ì ì´ë‚´)",
              "ğŸ“ ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸ 3 (50ì ì´ë‚´)"
            ],
            "codeExamples": [
              "ğŸ’» ì½”ë“œ ì˜ˆì œ ì„¤ëª… 1 (50ì ì´ë‚´)",
              "ğŸ’» ì½”ë“œ ì˜ˆì œ ì„¤ëª… 2 (50ì ì´ë‚´)"
            ],
            "practicalExamples": [
              "ğŸ› ï¸ ì‹¤ì „ ì ìš© ì˜ˆì‹œ 1 (50ì ì´ë‚´)",
              "ğŸ› ï¸ ì‹¤ì „ ì ìš© ì˜ˆì‹œ 2 (50ì ì´ë‚´)"
            ],
            "relevance": {
              "score": 0-100,
              "reason": "ì´ ìë£Œê°€ í”„ë¡œì íŠ¸ì— ë„ì›€ì´ ë˜ëŠ” ì´ìœ  (200ì ì´ë‚´)",
              "keyPoints": [
                "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 1 (50ì ì´ë‚´)",
                "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 2 (50ì ì´ë‚´)",
                "ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸ 3 (50ì ì´ë‚´)"
              ]
            }
          }
        ],
        "theme": "ğŸ¨ í…Œë§ˆ",
        "prerequisites": [
          {
            "category": "ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ",
            "items": [
              {
                "name": "ğŸ“š í•„ìˆ˜ ê¸°ìˆ ",
                "description": "ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ìœ„í•´ ë°˜ë“œì‹œ ì•Œì•„ì•¼ í•  ê¸°ìˆ ê³¼ ê°œë…ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ“– ê¶Œì¥ ê¸°ìˆ ",
                "description": "í”„ë¡œì íŠ¸ë¥¼ ë” íš¨ê³¼ì ìœ¼ë¡œ ì§„í–‰í•˜ê¸° ìœ„í•´ ì¶”ê°€ë¡œ í•™ìŠµí•˜ë©´ ì¢‹ì„ ê¸°ìˆ ê³¼ ê°œë…ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "âš™ï¸ ê°œë°œ í™˜ê²½",
            "items": [
              {
                "name": "ğŸ› ï¸ ê°œë°œ ë„êµ¬",
                "description": "í•„ìš”í•œ ê°œë°œ ë„êµ¬ì™€ ì„¤ì • ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ”§ í™˜ê²½ êµ¬ì„±",
                "description": "ë¡œì»¬ ê°œë°œ í™˜ê²½ êµ¬ì„±ì— í•„ìš”í•œ ë‹¨ê³„ì™€ ì£¼ì˜ì‚¬í•­ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "ğŸ“š ë„ë©”ì¸ ì§€ì‹",
            "items": [
              {
                "name": "ğŸ“– í•„ìˆ˜ ê°œë…",
                "description": "í”„ë¡œì íŠ¸ì˜ ë„ë©”ì¸ì— ëŒ€í•œ ì´í•´ë¥¼ ìœ„í•´ í•„ìš”í•œ í•µì‹¬ ê°œë…ê³¼ ìš©ì–´ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ“š ì°¸ê³  ìë£Œ",
                "description": "ë„ë©”ì¸ ì§€ì‹ì„ ìŒ“ê¸° ìœ„í•œ ì¶”ì²œ í•™ìŠµ ìë£Œë‚˜ ì°¸ê³ í•  ë§Œí•œ ì‚¬ë¡€ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          }
        ],
        "challenges": [
          {
            "category": "âš¡ ê¸°ìˆ ì  ë„ì „",
            "items": [
              {
                "name": "ğŸ¯ ì£¼ìš” ê³¼ì œ",
                "description": "í”„ë¡œì íŠ¸ì—ì„œ ë§ˆì£¼ì¹  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì  ë‚œê´€ê³¼ ê·¸ í•´ê²° ë°©í–¥ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "âš¡ ì„±ëŠ¥ ì´ìŠˆ",
                "description": "ì˜ˆìƒë˜ëŠ” ì„±ëŠ¥ ê´€ë ¨ ë¬¸ì œì ê³¼ ìµœì í™” ë°©ì•ˆì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "ğŸ—ï¸ ì•„í‚¤í…ì²˜",
            "items": [
              {
                "name": "ğŸ“ ì„¤ê³„ ê³ ë ¤ì‚¬í•­",
                "description": "ì‹œìŠ¤í…œ ì„¤ê³„ ì‹œ ê³ ë ¤í•´ì•¼ í•  ì£¼ìš” ì‚¬í•­ê³¼ í•´ê²°í•´ì•¼ í•  ì•„í‚¤í…ì²˜ì  ê³¼ì œë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ“ˆ í™•ì¥ì„±",
                "description": "ì‹œìŠ¤í…œ í™•ì¥ ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì ê³¼ ëŒ€ì‘ ë°©ì•ˆì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "ğŸ‘¥ ì‚¬ìš©ì ê²½í—˜",
            "items": [
              {
                "name": "ğŸ¨ UX/UI",
                "description": "ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì„ ìœ„í•´ í•´ê²°í•´ì•¼ í•  ê³¼ì œì™€ ì ‘ê·¼ ë°©ì‹ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "â™¿ ì ‘ê·¼ì„±",
                "description": "ë‹¤ì–‘í•œ ì‚¬ìš©ìë¥¼ ìœ„í•œ ì ‘ê·¼ì„± ê³ ë ¤ì‚¬í•­ê³¼ í•´ê²° ë°©ì•ˆì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          }
        ],
        "tips": [
          {
            "category": "ğŸ“‹ ê°œë°œ ì „ëµ",
            "items": [
              {
                "name": "ğŸš€ ì‹œì‘í•˜ê¸°",
                "description": "í”„ë¡œì íŠ¸ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‹œì‘í•˜ê¸° ìœ„í•œ ë‹¨ê³„ë³„ ì ‘ê·¼ ë°©ë²•ê³¼ ì´ˆê¸° ì„¤ì • íŒì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ“ ì½”ë“œ êµ¬ì¡°",
                "description": "ìœ ì§€ë³´ìˆ˜ì™€ í™•ì¥ì´ ìš©ì´í•œ ì½”ë“œ êµ¬ì¡°ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ëª¨ë²” ì‚¬ë¡€ì™€ íŒ¨í„´ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "âš¡ ê°œë°œ íš¨ìœ¨",
            "items": [
              {
                "name": "ğŸ“ˆ ìƒì‚°ì„±",
                "description": "ê°œë°œ ìƒì‚°ì„±ì„ ë†’ì´ê¸° ìœ„í•œ ë„êµ¬ í™œìš©ë²•ê³¼ ì›Œí¬í”Œë¡œìš° ìµœì í™” ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ§ª í…ŒìŠ¤íŠ¸",
                "description": "íš¨ê³¼ì ì¸ í…ŒìŠ¤íŠ¸ ì „ëµê³¼ ìë™í™” ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          },
          {
            "category": "ğŸ”§ ë¬¸ì œ í•´ê²°",
            "items": [
              {
                "name": "ğŸ› ë””ë²„ê¹…",
                "description": "ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ ìƒí™©ê³¼ íš¨ê³¼ì ì¸ ë””ë²„ê¹… ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              },
              {
                "name": "ğŸ“š ë¦¬ì†ŒìŠ¤",
                "description": "ë¬¸ì œ í•´ê²°ì— ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ìœ ìš©í•œ ë¦¬ì†ŒìŠ¤ì™€ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."
              }
            ]
          }
        ]
      }`;

  private static readonly TECH_STACK_GUIDELINES = `
      ê¸°ìˆ  ìŠ¤íƒ ì„¤ëª… ì‘ì„± ê°€ì´ë“œ:
      - ê° ê¸°ìˆ ì˜ ì„¤ëª…ì€ ë‹¤ìŒ í˜•ì‹ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”:
        * React: "âœ¨ ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ UI ê°œë°œì´ ê°€ëŠ¥í•´ìš”.", "âš¡ ê°€ìƒ DOMìœ¼ë¡œ ì„±ëŠ¥ì´ ì¢‹ì•„ìš”.", "ğŸ”„ ìƒíƒœ ê´€ë¦¬ê°€ í¸ë¦¬í•´ìš”."
        * TypeScript: "ğŸ›¡ï¸ íƒ€ì… ì•ˆì •ì„±ì´ ì¢‹ì•„ìš”.", "ğŸ’¡ ìë™ì™„ì„±ì´ í¸ë¦¬í•´ìš”.", "ğŸ“ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œìš”."
        * Node.js: "ğŸš€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì„œë²„ ê°œë°œì´ ê°€ëŠ¥í•´ìš”.", "âš¡ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ íš¨ìœ¨ì ì´ì—ìš”.", "ğŸ“¦ npm ìƒíƒœê³„ê°€ í’ë¶€í•´ìš”."
        * Python: "ğŸ“š ë°°ìš°ê¸° ì‰¬ìš´ ë¬¸ë²•ì´ì—ìš”.", "ğŸ“¦ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆì–´ìš”.", "ğŸ“Š ë°ì´í„° ë¶„ì„ì— ê°•í•´ìš”."
        * MongoDB: "ğŸ“„ ë¬¸ì„œ ê¸°ë°˜ NoSQLì´ì—ìš”.", "ğŸ”„ ìŠ¤í‚¤ë§ˆê°€ ìœ ì—°í•´ìš”.", "ğŸ“ˆ ìˆ˜í‰ í™•ì¥ì´ ì‰¬ì›Œìš”."
      
      - ì„¤ëª…ì€ ë°˜ë“œì‹œ ~ìš”ë¡œ ëë‚˜ë„ë¡ ì‘ì„±í•´ì£¼ì„¸ìš”
      - ê¸°ìˆ ì˜ í•µì‹¬ ê°€ì¹˜ì™€ ì¥ì ì„ ê°•ì¡°í•´ì£¼ì„¸ìš”
      - ì‹¤ì œ í”„ë¡œì íŠ¸ì—ì„œì˜ í™œìš© ë°©ì•ˆì„ í¬í•¨í•´ì£¼ì„¸ìš”
      - ë„ˆë¬´ ì „ë¬¸ì ì´ê±°ë‚˜ ì–´ë ¤ìš´ ìš©ì–´ëŠ” í”¼í•´ì£¼ì„¸ìš”`;

  private static readonly FEATURE_GUIDELINES = `
      ì£¼ìš” ê¸°ëŠ¥ ì‘ì„± ê°€ì´ë“œ:
      - ê° ê¸°ëŠ¥ ì˜ì—­ì€ ë‹¤ìŒ êµ¬ì¡°ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”:
        * mainTitle: í•´ë‹¹ ê¸°ëŠ¥ ì˜ì—­ì˜ í•µì‹¬ì„ ë‚˜íƒ€ë‚´ëŠ” ì œëª©
        * description: ê¸°ëŠ¥ ì˜ì—­ì— ëŒ€í•œ ì „ì²´ì ì¸ ì„¤ëª…
        * items: ì„¸ë¶€ ê¸°ëŠ¥ë“¤ì˜ ëª©ë¡
      
      - ê¸°ëŠ¥ ì˜ì—­ ì˜ˆì‹œ:
        {
          "mainTitle": "âœ¨ ì‹¤ì‹œê°„ íšŒì˜ ê´€ë¦¬",
          "description": "íšŒì˜ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ì§„í–‰í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•´ìš”.",
          "items": [
            {
              "title": "ğŸ“ ì‹¤ì‹œê°„ íšŒì˜ ìš”ì•½",
              "description": "íšŒì˜ ë‚´ìš©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ìš”ì•½í•´ì„œ ë³´ì—¬ë“œë ¤ìš”. íšŒì˜ê°€ ëë‚˜ë©´ ë°”ë¡œ ìš”ì•½ë³¸ì„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.",
              "keyPoints": [
                "ğŸ¯ ìŒì„± ì¸ì‹ìœ¼ë¡œ ìë™ ìš”ì•½",
                "ğŸ” ì£¼ìš” í‚¤ì›Œë“œ ìë™ ì¶”ì¶œ",
                "ğŸ“‹ íšŒì˜ ì¢…ë£Œ í›„ ì¦‰ì‹œ ìš”ì•½ë³¸ ì œê³µ"
              ]
            }
          ]
        }
      
      - ì„¤ëª… ì‘ì„± ì‹œ ë‹¤ìŒ ì‚¬í•­ì„ ê³ ë ¤í•´ì£¼ì„¸ìš”:
        * mainTitle: ê¸°ëŠ¥ ì˜ì—­ì˜ í•µì‹¬ ê°€ì¹˜ë¥¼ ê°„ë‹¨ëª…ë£Œí•˜ê²Œ í‘œí˜„
        * description: í•´ë‹¹ ê¸°ëŠ¥ ì˜ì—­ì´ ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” ì „ì²´ì ì¸ ê°€ì¹˜ ì„¤ëª…
        * ì„¸ë¶€ ê¸°ëŠ¥: êµ¬ì²´ì ì¸ ì‚¬ìš© ì‚¬ë¡€ì™€ ì¥ì ì„ í¬í•¨
      
      - ëª¨ë“  ì„¤ëª…ì€ ë°˜ë“œì‹œ ~ìš”ë¡œ ëë‚˜ë„ë¡ ì‘ì„±í•´ì£¼ì„¸ìš”
      - ì‚¬ìš©ì ê´€ì ì—ì„œ ê¸°ëŠ¥ì˜ ê°€ì¹˜ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”
      - ê¸°ìˆ ì  íŠ¹ì§•ë³´ë‹¤ëŠ” ì‚¬ìš©ìê°€ ì–»ì„ ìˆ˜ ìˆëŠ” ì´ì ì„ ê°•ì¡°í•´ì£¼ì„¸ìš”`;

  static getSystemPrompt(): string {
    return this.SYSTEM_PROMPT;
  }

  static constructUserPrompt(
    request: PromptRequest,
    existingProjects: Project[] = []
  ): string {
    const existingProjectsStr = this.formatExistingProjects(existingProjects);
    const themeConstraint = request.theme
      ? `ğŸ†• "${request.theme}" í…Œë§ˆì— ë§ëŠ” ë…ì°½ì ì¸ í”„ë¡œì íŠ¸`
      : "ğŸ†• ë…ì°½ì ì´ê³  í˜ì‹ ì ì¸ í”„ë¡œì íŠ¸";

    return `ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” ì°¸ì‹ í•˜ê³  ì‹¤ìš©ì ì¸ í”„ë¡œê·¸ë˜ë° í”„ë¡œì íŠ¸ë¥¼ ì¶”ì²œí•´ì£¼ì„¸ìš”:

      í•„ìˆ˜ ìš”êµ¬ì‚¬í•­:
      - ë¬¸ì¥ì€ ~ìš” ì´ëŸ° ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ì‚¬ìš©ìê°€ ê¸€ì— ê±°ë¶€ê°ì„ ëŠë¼ì§€ ì•Šë„ë¡ í•´ì£¼ì„¸ìš”.
      - ë‚œì´ë„: ${request.difficulty} (ë‚œì´ë„ë³„ ê¸°ì¤€ì„ ë°˜ë“œì‹œ ì¤€ìˆ˜í•´ì£¼ì„¸ìš”)
      - ì„ í˜¸í•˜ëŠ” ê¸°ìˆ : ${request.preferredTech.join(", ")}
      ${request.theme ? `- í”„ë¡œì íŠ¸ í…Œë§ˆ: ${request.theme}` : ""}
      ${request.description ? `- ì¶”ê°€ ì„¤ëª…: ${request.description}` : ""}

      ê¸°ì¡´ í”„ë¡œì íŠ¸ ëª©ë¡ (ì´ì™€ ìœ ì‚¬í•˜ì§€ ì•Šì€ ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ì œì‹œí•´ì£¼ì„¸ìš”):
      ${existingProjectsStr}
      
      ${this.PROJECT_CONSTRAINTS}
      
      ${this.PROJECT_CRITERIA}
        * ${themeConstraint}
      
      ${this.RESOURCE_EVALUATION_CRITERIA}
      
      ${this.TECH_STACK_GUIDELINES}
      
      ${this.FEATURE_GUIDELINES}
      
      ${this.JSON_SCHEMA}`;
  }

  private static formatExistingProjects(projects: Project[]): string {
    return projects
      .map(
        (p) => `
        - ì œëª©: ${p.title}
        - ìš”ì•½: ${p.description.summary}
        - ê¸°ìˆ  ìŠ¤íƒ: ${p.techStack.join(", ")}
        - í…Œë§ˆ: ${p.theme}
        - ë‚œì´ë„: ${p.difficulty}
        `
      )
      .join("\n");
  }
}
